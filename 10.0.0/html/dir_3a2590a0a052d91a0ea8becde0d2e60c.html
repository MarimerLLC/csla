<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CSLA .NET: csla/Source/Csla.Channels.RabbitMq Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="csla win8_compact.png"/></td>
  <td id="projectalign">
   <div id="projectname">CSLA .NET<span id="projectnumber">&#160;10.0.0</span>
   </div>
   <div id="projectbrief">A home for your business logic</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('dir_3a2590a0a052d91a0ea8becde0d2e60c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Csla.Channels.RabbitMq Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-files" class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:IRabbitMqPortalFactory_2Ecs" id="r_IRabbitMqPortalFactory_2Ecs"><td class="memItemLeft"><span class="icondoc"><div class="doc-icon"></div></span>&#160;</td><td class="memItemRight"><a class="el" href="_i_rabbit_mq_portal_factory_8cs.html">IRabbitMqPortalFactory.cs</a></td></tr>
<tr class="memitem:ProxyListener_2Ecs" id="r_ProxyListener_2Ecs"><td class="memItemLeft"><span class="icondoc"><div class="doc-icon"></div></span>&#160;</td><td class="memItemRight"><a class="el" href="_proxy_listener_8cs.html">ProxyListener.cs</a></td></tr>
<tr class="memitem:RabbitMqChannelExtensions_2Ecs" id="r_RabbitMqChannelExtensions_2Ecs"><td class="memItemLeft"><span class="icondoc"><div class="doc-icon"></div></span>&#160;</td><td class="memItemRight"><a class="el" href="_rabbit_mq_channel_extensions_8cs.html">RabbitMqChannelExtensions.cs</a></td></tr>
<tr class="memitem:RabbitMqPortal_2Ecs" id="r_RabbitMqPortal_2Ecs"><td class="memItemLeft"><span class="icondoc"><div class="doc-icon"></div></span>&#160;</td><td class="memItemRight"><a class="el" href="_rabbit_mq_portal_8cs.html">RabbitMqPortal.cs</a></td></tr>
<tr class="memitem:RabbitMqPortalFactory_2Ecs" id="r_RabbitMqPortalFactory_2Ecs"><td class="memItemLeft"><span class="icondoc"><div class="doc-icon"></div></span>&#160;</td><td class="memItemRight"><a class="el" href="_rabbit_mq_portal_factory_8cs.html">RabbitMqPortalFactory.cs</a></td></tr>
<tr class="memitem:RabbitMqPortalOptions_2Ecs" id="r_RabbitMqPortalOptions_2Ecs"><td class="memItemLeft"><span class="icondoc"><div class="doc-icon"></div></span>&#160;</td><td class="memItemRight"><a class="el" href="_rabbit_mq_portal_options_8cs.html">RabbitMqPortalOptions.cs</a></td></tr>
<tr class="memitem:RabbitMqProxy_2Ecs" id="r_RabbitMqProxy_2Ecs"><td class="memItemLeft"><span class="icondoc"><div class="doc-icon"></div></span>&#160;</td><td class="memItemRight"><a class="el" href="_rabbit_mq_proxy_8cs.html">RabbitMqProxy.cs</a></td></tr>
<tr class="memitem:RabbitMqProxyOptions_2Ecs" id="r_RabbitMqProxyOptions_2Ecs"><td class="memItemLeft"><span class="icondoc"><div class="doc-icon"></div></span>&#160;</td><td class="memItemRight"><a class="el" href="_rabbit_mq_proxy_options_8cs.html">RabbitMqProxyOptions.cs</a></td></tr>
<tr class="memitem:WorkInProgress_2Ecs" id="r_WorkInProgress_2Ecs"><td class="memItemLeft"><span class="icondoc"><div class="doc-icon"></div></span>&#160;</td><td class="memItemRight"><a class="el" href="_work_in_progress_8cs.html">WorkInProgress.cs</a></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="autotoc_md0"></a>
RabbitMq Data Portal Channel</h1>
<p>This data portal channel consists of <span class="tt">RabbitMqProxy</span> on the client and <span class="tt">RabbitMqPortal</span> to help create a server host.</p>
<p>Messages flow from client to server and back to the client through RabbitMQ queues. Messages contain a "return address", so when a client puts a message on the server's queue and the server processes that message, the server can use the "return address" to put the reply message on the client's queue. This implies that each client and each server will have its own queue. These queues are created by the data portal channel.</p>
<p>The channel requires a functioning RabbitMQ instance in your environment.</p>
<p>For testing purposes, the simplest way to get such an instance is to use a Docker container, such as the <a href="https://hub.docker.com/_/rabbitmq">RabbitMQ docker official image</a>.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md1"></a>
Creating a Host</h1>
<p>To create a host, you need to create a .NET project that can continually listen for inbound messages on the server's queue. The easiest way to do this is often to create a Console Application, though many other options can be implemented.</p>
<p>The host project needs to reference the <span class="tt"><a class="el" href="namespace_csla.html">Csla</a></span> and <span class="tt"><a class="el" href="namespace_csla_1_1_channels_1_1_rabbit_mq.html">Csla.Channels.RabbitMq</a></span> NuGet packages.</p>
<p>The host project should define a scoped service for <span class="tt">RabbitMqPortal</span>, and use that service to create and manage the data portal server "endpoint". You may be able to use the type directly, or you can create a subclass of the type for customization.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#</span></div>
<div class="line"> services.AddCsla(o =&gt; o</div>
<div class="line">   .DataPortal(o =&gt; o</div>
<div class="line">     .DataPortalServer(o =&gt; o</div>
<div class="line">       .UseRabbitMqPortal(o =&gt; o.DataPortalUrl = <span class="stringliteral">&quot;rabbitmq://host/queue&quot;</span>))));</div>
</div><!-- fragment --><p>In this example, <span class="tt">host</span> is the host name of the RabbitMQ service instance, and <span class="tt">queue</span> is the name of the server queue on which this data portal endpoint should listen.</p>
<p>You can provide RabbitMQ username and password details on the URI by following standard URI conventions for adding those values.</p>
<div class="fragment"><div class="line">rabbitmq://username:password@host/queue</div>
</div><!-- fragment --><blockquote class="doxtable">
<p>ℹ️ Note that multiple servers can listen on the same queue name to distribute the server load across multiple servers for load balancing and to achieve fault tolerance. </p>
</blockquote>
<p>In your main program code, use the injected service to start the endpoint:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#</span></div>
<div class="line"> rabbitMqPortal.StartListening();</div>
</div><!-- fragment --><p>The data portal will now process messages arriving on the queue until the app exits.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md2"></a>
Creating a Client</h1>
<p>A client app should use the <span class="tt">RabbitMqProxy</span> like any other data portal proxy. First by configuring it during app startup:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#</span></div>
<div class="line"> services.AddCsla(o =&gt; o</div>
<div class="line">   .DataPortal(o =&gt; o</div>
<div class="line">     .DataPortalClient(o =&gt; o</div>
<div class="line">       .UseRabbitMqProxy(o =&gt; o.DataPortalUrl = <span class="stringliteral">&quot;rabbitmq://host/queue&quot;</span>))));</div>
</div><!-- fragment --><p>In this example, <span class="tt">host</span> is the host name of the RabbitMQ service instance, and <span class="tt">queue</span> is the name of the server queue to which messages will be sent.</p>
<p>You can provide RabbitMQ username and password details on the URI by following standard URI conventions for adding those values.</p>
<div class="fragment"><div class="line">rabbitmq://username:password@host/queue</div>
</div><!-- fragment --><p>By default, the client will create an unnamed queue on which it will listen for replies from the server. You can provide a unique per-client queue name if you desire:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#</span></div>
<div class="line"> services.AddCsla(o =&gt; o</div>
<div class="line">   .DataPortal(o =&gt; o</div>
<div class="line">     .DataPortalClient(o =&gt; o</div>
<div class="line">       .UseRabbitMqProxy(o =&gt; o.DataPortalUrl = <span class="stringliteral">&quot;rabbitmq://host/queue?reply=[uniqueName]&quot;</span>))));</div>
</div><!-- fragment --><p>The client app can now use the data portal like normal, and all data portal requests will flow to the server via RabbitMQ messages. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_df4fcec8eb2892b40cd7060dc350478f.html">csla</a></li><li class="navelem"><a href="dir_f8b25ec5ab29df20004b8c7e5c09bf13.html">Source</a></li><li class="navelem"><a href="dir_3a2590a0a052d91a0ea8becde0d2e60c.html">Csla.Channels.RabbitMq</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
