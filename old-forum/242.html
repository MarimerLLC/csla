<html><header><title>Class Inheritance and Business Base</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Class Inheritance and Business Base</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/242.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tim FOrd posted on Thursday, June 01, 2006</h2>Hi All,<br><br>I need a little with the the understanding of the BusinessBase class and the use of the (of section)<br><br>I have 1 class called BestDay which has a set of properties etc<br><br>Public Class Bestday : Inherits BusinessBase(Of Bestday)<br><br>I also have a need for a customer Bestday Class and Location BestDay Class because i need to reuse all the properties from the bestday class and extended the interface with a customer id and location id. Is this possible??, i have tried this.<br><br>Public Class CustomerBestday : Inherits BusinessBase(Of Bestday)<br>Public Class LocationBestday : Inherits BusinessBase(Of Bestday)<br><br>But i can't and of the underlining bestday properties when i call this code from the interface.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim objCustomerBestDay As BusinessObjects.CustomerBestday<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; objCustomerBestDay.???? I only see the CustomerID property which i defined in CustomerBestdays<br><br>If this is possible i take it i will be able to overrides the dataportal section as i will need to call different storedprocedures to reutrn data. I have tried to explain this as best as possible, but as i'm starting out i have a feeling i might trying to run before i can walk.<br><br>Any help would be greatfully appreciated.<br><br>Thanks, Tim.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, June 01, 2006</h2>I think you need to change:<br><br>Public Class CustomerBestday : Inherits BusinessBase(Of Bestday)<br>Public Class LocationBestday : Inherits BusinessBase(Of Bestday)<br><br>to<br><br>Public Class CustomerBestday Inherits Bestday(Of Bestday)<br>Public Class LocationBestday Inherits Bestday(Of Bestday)<br><br><br>HTH<br>Andy <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tim FOrd replied on Thursday, June 01, 2006</h2>Hi Andy,<br><br>Thanks for you reply, i have tried both ways with no success. To to clarify i would like to inherit an object that has inherited the busines base object but still have the ability to over write methods etc. in the top level class.<br><br>so it would be like this<br><ul><li>business base</li><ul><li>best day</li></ul><ul><ul><li>customer best day</li></ul><ul><ul><li>location best day</li></ul></ul></ul></ul>the customer and location class would have a nother property attached to them to define the customer and location id. But i would still like to override the fetch methods etc to call different sotred procedures.<br><br>I know this is not very clear, but it the best that i can exaplin on what i'm trying to acheive.<br><br>Thanks, Tim.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, June 01, 2006</h2>Hmm,<br><br>What about:<br><br>Public Class CustomerBestday Inherits Bestday(Of CustomerBestDay)<br>Public Class LocationBestday Inherits CustomerBestday (Of LocationBestday )<br><br>Sorry, I'm not very good with VB; it coudl just be that you need to recompile or restart the IDE.&nbsp; <br><br>I know there are a few rare occasions when VS2003 would 'forget' some of the properties / methods of an object because Intillisense gets trashed.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tim FOrd replied on Thursday, June 01, 2006</h2>Right lets get it simpler.<br><br>BestDay class inherits BusinessBase(of BestDay)<br><br>I need to extend the interface of best day in to a CustomerBestDay class<br><br>Which i'm pretty sure we are on the right line of<br><br>Public Class CustomerBestDay: Inherits Bestday(of CustomerBestDay)<br>Or<br>Public Class CustomerBestDay: Inherits Bestday(of BestDay)<br><br>when i try and define either of the above in the class i get this error:-<br><br>Error&nbsp;&nbsp;&nbsp; 24&nbsp;&nbsp;&nbsp; 'BusinessObjects.Bestday' has no type parameters and so cannot have type arguments. <br><br>Cheers for your help andy.<br><br>Tim.&nbsp;  <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, June 01, 2006</h2>Generics complicates inheritance rather a lot - that's one major drawback to their use.<br><br>You need to declare BestDay as a generic base class (and thus probably abstract):<br><br>Public MustInherit Class BestDay(Of T As BestDay(Of T))<br>&nbsp; Inherits BusinessBase(Of BestDay(Of T))<br><br>Pretty much just like BusinessBase is declared. Then you can create your subclass:<br><br>Public Class CustomerBestDay : Inherits BestDay(Of CustomerBestDay)<br><br>Make sure you are using CSLA 2.0.1, because it includes a fix to allow the data portal to work properly with this sort of inheritance scheme.<br><br>If this doesn't get you want you want, then you need to avoid using generics - at least all the way through your hierarchy. Specifically, if you want to be able to create an instance of BestDay directly, then that must be the end of the generic inheritance chain, and your CustomerBestDay can't have strongly typed Save() and Clone() methods - they'll be of type BestDay and you'll need to cast the results yourself.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tim FOrd replied on Thursday, June 01, 2006</h2>Guys, thanks for you help exactly what i wanted.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tim FOrd replied on Friday, June 02, 2006</h2>Guys,<br><br>I seem to be getting an error when i now try and create a new instance of the CustomerBestDay Class<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function NewBestDay() As BestDay(Of CustomerBestDay)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not CanAddObject() Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Throw New System.Security.SecurityException("User not authorized to add a BestDay")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return DataPortal.Create(Of CustomerBestDay)()<br><br>&nbsp;&nbsp;&nbsp; End Function<br><br>and this<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function NewBestDay() As BestDay(Of CustomerBestDay)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not CanAddObject() Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Throw New System.Security.SecurityException("User not authorized to add a BestDay")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return DataPortal.Create(Of BestDay(Of CustomerBestDay))()<br><br>&nbsp;&nbsp;&nbsp; End Function<br><br>The error i get is {"Cannot create an abstract class."}and i just call the create method incorrectly or am i barking up the wrong tree here??<br><br>Thanks, Tim.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tim FOrd replied on Friday, June 02, 2006</h2>Just for reference, i have had a look on the forums and found this http://forums.lhotka.net/forums/thread/1205.aspx which is exactly the same issue.<br><br>Tim.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Friday, June 02, 2006</h2>Make sure your criteria class is either in your derived class or if you keep it in your base class, make it inherit from criteria base.<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tim FOrd replied on Friday, June 02, 2006</h2>i Have this in my CustomerBestDay Class is that right??&nbsp;  <br><br>&nbsp;&lt;Serializable()&gt; _<br>&nbsp; Private Class Criteria<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Private mId As Guid<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Public ReadOnly Property Id() As Guid<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mId<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Public Sub New(ByVal id As Guid)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mId = id<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Sub<br>&nbsp;&nbsp;&nbsp; End Class<br><br>Sorry for being slack, but i haven't really used a framwork like this before. So quite a steap learning curve.<br><br>thansk, Tim.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Friday, June 02, 2006</h2>Sorry, I missread your message.<br>Your factory method should be inside CustomerBestDay.<br><br>Public Shared Function NewCustomerBestDay() As CustomerBestDay<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not CanAddObject() Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Throw New System.Security.SecurityException("User not authorized to add a BestDay")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return DataPortal.Create(Of CustomerBestDay)()<br>End Function<br><br><br>Criteria doesn't participate in create in this instance. Also, if you don't need to bring default values from the db you should either mark your dataportal_create method as RunLocal() or just do a:<br>&nbsp;Return New CustomerBestDay<br>inside your factory method.<br><br>If you're still having trouble, post the exact factory method that fails and tell us where the factory method is. Also post the declarations for each of the classes.<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tim FOrd replied on Friday, June 02, 2006</h2>Hi xal,<br><br>I have just this&nbsp; minute got it working, a small error on my side ;) i had declare customerbestdays as mustinherit and thus getting the error "Cannot create abstract class" sorry about that.<br><br>But as i'm learning can you please tell me which one is the correct way of define this function.<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function NewBestDay(ByVal CustomerID As Guid) As BestDay(Of CustomerBestDay)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not CanAddObject() Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Throw New System.Security.SecurityException("User not authorized to add a bestday")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim objCriteria As New Criteria(CustomerID)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return DataPortal.Create(Of CustomerBestDay)(objCriteria)<br><br>&nbsp;&nbsp;&nbsp; End Function<br><br>OR<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function NewBestDay(ByVal CustomerID As Guid) As CustomerBestDay<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not CanAddObject() Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Throw New System.Security.SecurityException("User not authorized to add a bestday")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return DataPortal.Create(Of CustomerBestDay)()<br><br>&nbsp;&nbsp;&nbsp; End Function<br><br>The main difference being the Method declaration<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Friday, June 02, 2006</h2>Well, both return a strongly typed object of type CustomerBestDay, the difference is semanthic I'd say. I'd go with "As CustomerBestDay" instead of the other because it's simpler and more straightforward.<br><br>Andrés<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
