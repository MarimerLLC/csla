<html><header><title>Object Inheritance - Save Function - Return Type forced to BaseClass</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Object Inheritance - Save Function - Return Type forced to BaseClass</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/53.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>RanceDowner1234 posted on Tuesday, May 09, 2006</h2>Hey all I'm a newbie to the CSLA.net framework, but so far I am finding it to be great, when creating non-inherited classes.&nbsp; I've created several of these non-inherited classes in an accounting application I'm writing, but now I'm getting to a more complex part of the coding where I'm trying to implement Object Inheritance.<br><br>I have an object called PhoneCompanyStatement, derived from StatementBase, derived from LineItemBase, which is finally derived from BusinessBase(Of LineItemBase).&nbsp; I will have other objects such as GasCompanyStatement, ElectricCompanyStatement, etc that derive from StatementBase too.&nbsp; <br><br>It seems to be standard OOP.&nbsp; My PhoneCompanyStatement has all but 4 public properties in common with a GasCompanyStatement, ElectricCompanyStatment, etc.&nbsp; So I created a base class called StatementBase which contains some 20 properties that "all" statments have in common.&nbsp; <br><br>In turn a "Statement" is just a "line item" which has fields in common with PaymentBase and PenaltyBase.&nbsp; So I created a LineItemBase on which StatmentBase, PaymentBase, and PenaltyBase will all derive.<br><br>But while creating the Factory Methods I tried the following line of code I get two compile errors on the Save Override:<br><br>&lt;System.Serializable()&gt; _<br>Public Class PhoneCompanyStatement<br>&nbsp;&nbsp;&nbsp; Inherits StatementBase 'Note: StatementBase inherits LineItemBase, which inherits BusinessBase(Of LineItemBase)<br><br>''' Other Code<br><br>#Region " Factory Methods "<br><br>&nbsp;&nbsp;&nbsp; Public Overrides Function Save() As <font color="#ff0000"><b><i>PhoneCompanyStatement</i></b></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return MyBase.Save<br>&nbsp;&nbsp;&nbsp; End Function<br><br>#End Region<br><br>''' Other Code <br><br>End Class<br><br>I get two compile errors:<br><br>Error&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 'Public Overrides Function Save() As PhoneCompanyStatement' cannot override 'Public Overridable Function Save() As LineItemBase' because they differ by their return types.&nbsp;&nbsp;&nbsp; <br><br>Error&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; Option Strict On disallows implicit conversions from 'FeesDataObjects.LineItemBase' to 'FeesDataObjects.PhoneCompanyStatement'.<br><br>I can only make the compile errors go away if I change the return type of the save function to the lowest level BaseClass type.<br><br>&nbsp;&nbsp;&nbsp; Public Overrides Function Save() As <font color="#ff0000"><b><i>LineItemBase</i></b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return MyBase.Save<br>
&nbsp;&nbsp;&nbsp; End Function<br><br>Is this a good idea?&nbsp; It just doesn't look right to me.&nbsp; It doesn't seem standard OOP to me.&nbsp; But maybe I'm wrong?<br><br>Has anybody worked with Inheritance chains like this before in CSLA.net.&nbsp; And if so how did you implement the Save Function.<br><br>Thanks for any help.<br><br>Rance Downer<br>rancedowner1234@hotmail.com<br><br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Tuesday, May 09, 2006</h2><P>My guess is that the reason the "compiler" likes LineItemBase is because that is the final type Of generic(for lack of a better term) you have declared.&nbsp; In other words, I think, that you are saying that your inheritance looks like this:</P>
<P>Public Class LineItemBase<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Inherits Csla.BusinessBase(<STRONG><EM>Of LineItemBase</EM></STRONG>)</P>
<P>Public Class StatementBase<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Inherits LineItemBase</P>
<P>Public Class PhoneCompanyStatement<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Inherits StatementBase</P>
<P>As far as the Return value from Save is concerned, it is okay even if it is LineItemBase - you will just need to cast it back&nbsp;like:&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mystatement = CType(Mystatement.Save(),&nbsp;PhoneCompanyStatement)</P>
<P>and you will only need to do that if you are going to continue to use "MyStatement" object <STRONG><EM>after</EM></STRONG> the Save.&nbsp; If you are not, it don't mean noth'n&nbsp;whatcha got back since y'all gonna squash it anyway.</P>
<P>Jav</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Gigatron replied on Wednesday, May 10, 2006</h2><P>I have have a similar need for my project.&nbsp; Jav's suggestion helped, but my generics looked like this:</P><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> AddressBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> AddressBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> BusinessBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T)</FONT></P><FONT size=2><FONT color=#0000ff size=2>
<P>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Public</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2><FONT color=#000000> CentreAddress<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> AddressBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> CentreAddress)</FONT></P><FONT size=2><FONT color=#0000ff size=2>
<P>End</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>Class<BR></FONT><FONT color=#0000ff size=2></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#000000>Is this correct way of approaching?&nbsp; It compiles, but I haven't tested yet.</FONT></P></FONT></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Wednesday, May 10, 2006</h2><P>Gigatron</P>
<P>It looks like AddressBase is the final class in your inheritance.&nbsp; If that is the case, then I would simply do this.</P>
<P>Public Class AddressBase<BR>&nbsp;&nbsp;&nbsp;&nbsp; Inherits Csla.BusinessBase(Of AddressBase)</P>
<P>Otherwise - if you do it your way, every place you have to express the Type of AddressBase, you will run into problems.&nbsp; For example, when you declare</P>
<P>Private MyAddress As AddressBase</P>
<P>the compiler would not let you do that.</P>
<P>Jav</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Wednesday, May 10, 2006</h2>Gigatron<BR>Sorry - I did not read your entire post.&nbsp; Yes you are doing it right.<BR>Jav</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Tuesday, May 09, 2006</h2>Hey!<br><br>It sounds like you should be creating your base classes&nbsp; generic.<br><br>Like <br><br><br>Public Class LineItemBase(Of T as LineItemBase)<br>&nbsp;&nbsp;&nbsp; Inherits BusinessBase(Of T)<br>...<br>End Class<br><br>and<br><br>Public Class StatementBase(Of T as StatementBase)<br>
&nbsp;&nbsp;&nbsp; Inherits LineItemBase(Of T)<br>
...<br>
End Class<br><br><br>Your final class will be <br>Public Class PhoneCompanyStatement<br>&nbsp;&nbsp;&nbsp; Inherits StatementBase(Of PhoneCompanyStatement)<br>...<br>End Class<br><br><br>I hope it helps!<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RanceDowner1234 replied on Wednesday, May 10, 2006</h2>Thanks.&nbsp; I will try the generics route.&nbsp; <br><br>Most of the time I only call Save( ) as a subroutine for instance I'll say:<br><br><font color="#ff0000"><b>Call </b><font color="#000000">PhoneCompanyStatement.Save( ) </font></font><br><br>But I just figured if other people in my company used my object it might be nice if they could count on the return value being passed back as same type as the object.&nbsp; <br><br>I suppose it's not too bad if they <i>cast </i>it back like:<br><br>Dim myReturn As LineItemBase<br>myReturn = PhoneCompanyStatement.Save( )<br><br>Dim newObj As PhoneCompanyStatment<br>newObj = CType(myReturn, PhoneCompanyStatement)<br><br>But for some reason that just didn't seem right.<br><br>But if I have a hard time with the generics... as I've used generics before, but never <i>built </i>them... I'll go the Cast route instead.&nbsp; <br><br>But for now, thanks for the advice on the generics.&nbsp; I'll give that a schoolhouse try!<br><br>Much thanks to both of you for your help!<br><br><i>Rance </i><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RanceDowner1234 replied on Wednesday, May 10, 2006</h2>Just wanted to let you know.&nbsp; The generics worked beautifully!!!&nbsp; Gracias, gracias mi amigo.<br><br>I was a little nervous at first, but really it wasn't that hard to build.&nbsp; It was just a matter of declaring the types correctly.&nbsp; It was almost exactly as xal's code two threads above.&nbsp; With one minor tweak.&nbsp; I will post the change in case anyone else can benefit from the experience.&nbsp; <br><br>Here's the Final Code...&nbsp; The basic addition was the "(Of T)" lines...<br><br>Public MustInherit Class LineItemBase(Of T As LineItemBase<i><b>(Of T)</b></i>)<br>&nbsp;&nbsp;&nbsp; Inherits BusinessBase(Of T)<br><br>Public MustInherit Class StatementBase(Of T As StatementBase<i><b>(Of T)</b></i>)<br>&nbsp;&nbsp;&nbsp; Inherits LineItemBase(Of T)<br><br>Public Class PhoneCompanyStatement<br>&nbsp;&nbsp;&nbsp; Inherits StatementBase(Of PhoneCompanyStatement)<br><br>&nbsp;&nbsp;&nbsp; ''''Other factory methods like GetInstance(byval id as Integer)<br><br>&nbsp;&nbsp;&nbsp; 'This line works now!!!!<br>&nbsp;&nbsp;&nbsp; Public Overrides Function Save() As <u>PhoneCompanyStatement</u><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return MyBase.Save<br>&nbsp;&nbsp;&nbsp; End Function<br><br>End Class<br><br>Other code...<br><br>Dim Obj As PhoneCompanyStatement<br>Obj = PhoneCompanyStatement.GetInstance([id])<br><br>Dim copyObj As PhoneCompanyStatement<br>copyObj = Obj.Save( )<br><br>Thanks again Guys.&nbsp; I might be able to use this generics stuff in other places now too!<br><br><i>Rance</i><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, May 10, 2006</h2>Oops!<br>How about having the forum engine compile the code samples we post? <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br>Or better yet, intellisense!<br><br>Sorry.<br>Anyway, I'm glad you found your way!<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>lazaroms replied on Saturday, July 10, 2010</h2><p>Hola Andr&eacute;s:</p>
<p>&iquest;Pudieras dejarme un correo para hacerte algunas consultas en 
espa&ntilde;ol?</p>
<p>Saludos,</p>
<p>&nbsp;</p>
<p>Lazaro Manuel Santin.</p>
<p>Lmsantin@yahoo.es</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
