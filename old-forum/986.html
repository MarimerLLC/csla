<html><header><title>newbie questions</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>newbie questions</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/986.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>yipchunyu posted on Wednesday, August 23, 2006</h2>Just in the very beginning stage of our new content managment sys.<br>some questions for all of you.<br>1. I tired to build a class diagram inside visual studio 2005.&nbsp; (just as the case in page 342 of the book" Expert VB 2005 Business object").&nbsp; in the book, the solid-line represent collaboration between objects and dashed lines seems to represents possible to navigate.&nbsp; However, in VS2005, it represents different things ie. inheritance and association.&nbsp; So, any advice on this issue?<br>2. I don't truely understand the best practice to handle attachments in our cases.&nbsp; Should we stored in DB and act as a property in the business object (the whole attachment)?&nbsp; or should it just a pointer to a file system?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, August 23, 2006</h2>I used the class diagram tool to create the basic class diagrams, which are in the code download and available from <a href="http://www.lhotka.net/cslanet/download.aspx">www.lhotka.net/cslanet/download.aspx</a>.<br><br>However, in the book I merely used a similar notation. It turns out that the class diagram in VS is incapable of illustrating all the relationships and concepts I needed to show in the book, and so the book's diagrams are "inspired" by the class diagram in terms of graphics, but are not created by the class diagram tool in VS.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yipchunyu replied on Wednesday, August 23, 2006</h2>Hi Rocky,<br>If i use Visio to build the object model. <br>should i use "generation", "Binary assosication", "Composition", "link", "dependency" ... to represent the relationship presented the chart shown in page 342?<br><br><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div>I used the class diagram tool to create the basic class diagrams, which are in the code download and available from <a href="http://www.lhotka.net/cslanet/download.aspx">www.lhotka.net/cslanet/download.aspx</a>.<br><br>However, in the book I merely used a similar notation. It turns out that the class diagram in VS is incapable of illustrating all the relationships and concepts I needed to show in the book, and so the book's diagrams are "inspired" by the class diagram in terms of graphics, but are not created by the class diagram tool in VS.<br></div></BLOCKQUOTE></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, August 23, 2006</h2>Well, there are advantages and disadvantages to storing attachments in the database vs. on the file system.&nbsp; I opted to store attachments in the database to easy backup / restore requirements.&nbsp; All the data is in one place.&nbsp; <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yipchunyu replied on Wednesday, August 23, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>Well, there are advantages and disadvantages to storing attachments in the database vs. on the file system.&nbsp; I opted to store attachments in the database to easy backup / restore requirements.&nbsp; All the data is in one place.&nbsp; <br></div></BLOCKQUOTE><br>but will not be an issue if the file size is not small in average (5MB ~ 10MB) as using the business objects concept with CSLA?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, August 24, 2006</h2>It depends on your environment.&nbsp; This choice has little to do with Csla, since with or without Csla, you still have to determine how fast 10 meg can get from the database to the client machine.&nbsp; Will it be faster or slower than opening a file on a share?&nbsp; You'll have to do some testing.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Thursday, August 24, 2006</h2><P>The general rule of thumb as recommended by DBA's is to NOT store binary information inline with your records in a database.&nbsp; While I have seen and made arguments for doing so, the preferred route is to store a reference to the file&nbsp;located in the physical file system.&nbsp; Of course, there are always exceptions - that's why it's a rule of thumb.&nbsp; If you have a solid reason for embedding, then do so; otherwise, lean towards using the file system.</P>
<P>My understanding of the rationale has to do with performance scanning and retrieving records.&nbsp; Like you inferred, the larger the attachment, the larger the record.&nbsp; Obviously this plays a role in the performance you see in your DB when trying to retrieve records.</P>
<P>Also consider that in most cases, especially with web apps, all you need is the reference to the file at first glance anyway.&nbsp; Attachments are typically shown as a link so you don't need the binary&nbsp;column with the rest of the data anyway.</P>
<P>And, in all of our applications (preference), our attachments are defined in a separate table that references the parent (document) because they are optional have a many-to-one relationship with the parent doc.&nbsp; While this does reduce the impact on the parent table, you still have to perform a join to the attachments table to retrieve the list.</P>
<P>Ultimately, much like almost everything else we do, it is up to you.</P>
<P>Hope that helps.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, August 24, 2006</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>SonOfPirate:</strong></div><div>And, in all of our applications (preference), our attachments are
defined in a separate table that references the parent (document)
because they are optional have a many-to-one relationship with the
parent doc.&nbsp; While this does reduce the impact on the parent table, you
still have to perform a join to the attachments table to retrieve the
list.</div></BLOCKQUOTE><br><br>This is what I do as well.&nbsp; If you don't need the attachment, you don't need to join at all, and your performance should not suffer.&nbsp; Aside from that, I'm not sure what the arguments against storing binary data in the database are.&nbsp; <br><br><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>SonOfPirate:</strong></div><div>If you have a solid reason for embedding, then do so; otherwise, lean towards using the file system.</div></BLOCKQUOTE><br><br>I'd say lean toward storing in the database; you cannot maintain the integrity of data which is not stored in the database, and files are pieces of data which can easily be modifed by anyone (assuming permissions).&nbsp; Also, you have more overhead for backup, a huge PITA should you need to move the file store for some reason, etc.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Thursday, August 24, 2006</h2>Well, I did say the rule of thumb came from DBA's.........</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, August 24, 2006</h2>Fair enough <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br><br>What are their reasons though?&nbsp; Just curious..<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Thursday, August 24, 2006</h2><P>I would have to ask again, but what I remember has to do with performance in general with large data types (binary, image, ntext, etc.).&nbsp; There was also an issue of data-portability from platform to platform should that need arise.</P>
<P>From a development standpoint it also makes life easier to deal with a file system, obviously, because your not contending with streaming content and can allow the OS to handle retrieving the file.&nbsp; Changes to the file system are easily handled by using a config setting to indicate the physical path and only storing relative paths in the database.&nbsp; But you are right about data integrity as someone can obviously remove the file with a reference remaining in the db (my biggest argument with the DBA's!)</P>
<P>Oh, another issue presented by the DBA's was the size and time required to backup the database when 2/3 of its size are blobs that could be stored externally.&nbsp; The contents of the file will most likely change much less frequently than the database contents, so separating them would separate the backup requirements as well.</P>
<P>I know there was more and am sure there are a ton of articles online listing the pro's and con's.&nbsp; Not saying I agree 100%; as I said, I've made arguments for doing so as well.&nbsp; It's just the rule of thumb I've been told.&nbsp; I think the application dictates more than the DBA (at least for me) if we're going to follow the rule of thumb or not.&nbsp; I typically look at the size and quantity of the files and use that as a guideline.&nbsp; If you are dealing with a LOT of files and/or files that have substantial size, then why bog your database down with the task of streaming the file when you can leave it to do its job (managing data) and let the file system manage the files?</P>
<P>Everything in programming is subjective, eh?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Thursday, August 24, 2006</h2>A well designed DB can have different FileGroups and files. You could easily create an mdf for the purpose of holding large blobs of binary data and that way you wouldn't suffer fragmentation or bottlenecks when working with regular data.<br>Of course, DBAs don't want to have to maintain this structure, so the will want you to put the binary information directly into disk. <img src="/emoticons/emotion-2.gif" alt="Big Smile [:D]" /><br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yipchunyu replied on Monday, August 28, 2006</h2>thx all for your advice.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>guyroch replied on Monday, August 28, 2006</h2><P>I agree with the general spirit of this thread in that a DB is design to store data and a file system is design to store files.&nbsp; With that said I would definitly store the attachements on the file system.&nbsp; In fact I had that very similar use case a few months ago.&nbsp; I had attachements stored into the database and that did put a pay load on performance and had to revert back to storing the attachements on the file system instead of the DB.&nbsp; Take it from me, store the attachements on the file system.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yipchunyu replied on Tuesday, August 29, 2006</h2>a related question. <br>In the above case, the attachment(s) is one of the property of the object 'document' (in my design).&nbsp; Must I seperate it as a new classes or use some other way to handle this? (assuming that I just stored the file reference in another table in DB)<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, August 29, 2006</h2>What is the attachement now?&nbsp; A byte array?&nbsp; I would say seperate it into its own class which knows how to 'persist' itself.&nbsp; Then if you ever want to change how you store the attachment (file vs. db)&nbsp; you'll have one class to change and its parent will be none the wiser.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
